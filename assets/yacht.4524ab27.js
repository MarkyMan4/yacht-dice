import"./style.c0ed6924.js";let y=sessionStorage.getItem("roomId"),m=sessionStorage.getItem("nickname"),i="",u=!1,a=document.getElementById("roll-btn"),f=document.getElementById("p1-upper-sum"),g=document.getElementById("p2-upper-sum"),I=document.getElementById("p1-total"),E=document.getElementById("p2-total"),s=document.getElementById("message-text"),T=document.getElementById("rolls-left-text");const c=["aces","deuces","threes","fours","fives","sixes","fourOfAKind","fullHouse","smallStraight","largeStraight","chance","yacht"];let d=new WebSocket(`wss://yachtdiceservice.xyz/ws/${y}`);d.onmessage=e=>{let t=JSON.parse(e.data);if(u||(L(t),u=!0),$(t),h(t),t.winner.trim()!=""){t.winner==="tie"?s.innerHTML="tie":s.innerHTML=`${t.winner} wins!`,s.style.color="blue";return}b(t),B(t),a.disabled=t.turn!==i||t.rollsLeft<=0,T.innerHTML=`rolls left: ${t.rollsLeft}`,t.turn===i&&t.rollsLeft<3?S(t.scoreCard[i]):k(t.scoreCard[i])};d.onopen=e=>{d.send(JSON.stringify({eventType:"name",payload:{name:m}}))};a.addEventListener("click",()=>{let e={eventType:"roll"};d.send(JSON.stringify(e))});function L(e){document.getElementById("waiting-text")&&document.getElementById("waiting-text").remove(),document.getElementById("game").style.visibility="visible",i=e.p1.nickname===m?"p1":"p2",document.getElementById("you-title").innerHTML=`You are ${i}`,document.getElementById("p1-head").innerHTML=`p1<br>${e.p1.nickname}`,document.getElementById("p2-head").innerHTML=`p2<br>${e.p2.nickname}`}function $(e){p("p1",e.scoreCard.p1),p("p2",e.scoreCard.p2),f.innerHTML=e.upperTotals.p1,g.innerHTML=e.upperTotals.p2,I.innerHTML=e.totals.p1,E.innerHTML=e.totals.p2}function p(e,t){let l=Object.keys(t);l.forEach(n=>{document.getElementById(`${e}-${n}`).innerHTML=t[n],document.getElementById(`${e}-${n}`).className="scored-cell"}),c.forEach(n=>{l.includes(n)||(document.getElementById(`${e}-${n}`).innerHTML="")})}function B(e){Object.keys(e.scoreHints).forEach(t=>{document.getElementById(`${e.turn}-${t}`).innerHTML=e.scoreHints[t]})}function S(e){let t=Object.keys(e);c.forEach(l=>{t.includes(l)||(document.getElementById(`${i}-${l}`).onclick=H,document.getElementById(`${i}-${l}`).className="selectable-cell")})}function k(e){let t=Object.keys(e);c.forEach(l=>{document.getElementById(`${i}-${l}`).onclick=null,t.includes(l)||(document.getElementById(`${i}-${l}`).className="unscored-cell")})}function H(e){let t=e.target.id.split("-"),n={eventType:"score",payload:{category:t[t.length-1]}};d.send(JSON.stringify(n))}function v(e){let t=e.target.id.split("-"),n={eventType:"keep",payload:{die:parseInt(t[t.length-1])}};d.send(JSON.stringify(n))}function M(e){let t=e.target.id.split("-"),n={eventType:"unkeep",payload:{die:parseInt(t[t.length-1])}};d.send(JSON.stringify(n))}function h(e){let t="";for(let n=0;n<e.diceInPlay.length;n++){let o=e.diceInPlay[n];t+=`<div id="die-in-play-${n}" class="die-in-play">${o}</div>`}document.getElementById("dice-in-play").innerHTML=t;let l="";for(let n=0;n<e.diceKept.length;n++){let o=e.diceKept[n];l+=`<div id="die-kept-${n}" class="die-kept">${o}</div>`}if(document.getElementById("dice-kept").innerHTML=l,!(e.rollsLeft>=3)&&e.turn===i){let n=document.getElementsByClassName("die-in-play");for(let r of n)r.addEventListener("click",v);let o=document.getElementsByClassName("die-kept");for(let r of o)r.addEventListener("click",M)}}function b(e){e.turn===i?s.innerHTML="your turn":s.innerHTML=`${e.turn} is rolling...`,s.style.color="red"}
