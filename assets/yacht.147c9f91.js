import"./style.c0ed6924.js";let f=sessionStorage.getItem("roomId"),a=sessionStorage.getItem("nickname"),i="",u=!1,p=document.getElementById("roll-btn"),y=document.getElementById("p1-total"),g=document.getElementById("p2-total"),o=document.getElementById("message-text"),I=document.getElementById("rolls-left-text");const c=["aces","deuces","threes","fours","fives","sixes","fourOfAKind","fullHouse","smallStraight","largeStraight","chance","yacht"];let d=new WebSocket(`ws://localhost:8000/ws/${f}`);d.onmessage=e=>{let t=JSON.parse(e.data);if(console.log("received from server: ",t),u||(E(t),u=!0),$(t),H(t),t.winner.trim()!=""){t.winner==="tie"?o.innerHTML="tie":o.innerHTML=`${t.winner} wins!`,o.style.color="blue";return}h(t),T(t),p.disabled=t.turn!==i||t.rollsLeft<=0,I.innerHTML=`rolls left: ${t.rollsLeft}`,t.turn===i&&t.rollsLeft<3?L(t.scoreCard[i]):B(t.scoreCard[i])};d.onopen=e=>{d.send(JSON.stringify({eventType:"name",payload:{name:a}}))};p.addEventListener("click",()=>{let e={eventType:"roll"};d.send(JSON.stringify(e))});function E(e){document.getElementById("waiting-text")&&document.getElementById("waiting-text").remove(),document.getElementById("game").style.visibility="visible",i=e.p1.nickname===a?"p1":"p2",document.getElementById("you-title").innerHTML=`You are ${i}`,document.getElementById("p1-head").innerHTML=`p1<br>${e.p1.nickname}`,document.getElementById("p2-head").innerHTML=`p2<br>${e.p2.nickname}`}function $(e){m("p1",e.scoreCard.p1),m("p2",e.scoreCard.p2),y.innerHTML=e.totals.p1,g.innerHTML=e.totals.p2}function m(e,t){let l=Object.keys(t);l.forEach(n=>{document.getElementById(`${e}-${n}`).innerHTML=t[n],document.getElementById(`${e}-${n}`).className="scored-cell"}),c.forEach(n=>{l.includes(n)||(document.getElementById(`${e}-${n}`).innerHTML="")})}function T(e){Object.keys(e.scoreHints).forEach(t=>{document.getElementById(`${e.turn}-${t}`).innerHTML=e.scoreHints[t]})}function L(e){let t=Object.keys(e);c.forEach(l=>{t.includes(l)||(document.getElementById(`${i}-${l}`).onclick=k,document.getElementById(`${i}-${l}`).className="selectable-cell")})}function B(e){let t=Object.keys(e);c.forEach(l=>{document.getElementById(`${i}-${l}`).onclick=null,t.includes(l)||(document.getElementById(`${i}-${l}`).className="unscored-cell")})}function k(e){let t=e.target.id.split("-"),n={eventType:"score",payload:{category:t[t.length-1]}};d.send(JSON.stringify(n))}function v(e){let t=e.target.id.split("-"),n={eventType:"keep",payload:{die:parseInt(t[t.length-1])}};d.send(JSON.stringify(n))}function S(e){let t=e.target.id.split("-"),n={eventType:"unkeep",payload:{die:parseInt(t[t.length-1])}};d.send(JSON.stringify(n))}function H(e){let t="";for(let n=0;n<e.diceInPlay.length;n++){let s=e.diceInPlay[n];t+=`<div id="die-in-play-${n}" class="die-in-play">${s}</div>`}document.getElementById("dice-in-play").innerHTML=t;let l="";for(let n=0;n<e.diceKept.length;n++){let s=e.diceKept[n];l+=`<div id="die-kept-${n}" class="die-kept">${s}</div>`}if(document.getElementById("dice-kept").innerHTML=l,!(e.rollsLeft>=3)&&e.turn===i){let n=document.getElementsByClassName("die-in-play");for(let r of n)r.addEventListener("click",v);let s=document.getElementsByClassName("die-kept");for(let r of s)r.addEventListener("click",S)}}function h(e){e.turn===i?o.innerHTML="your turn":o.innerHTML=`${e.turn} is rolling...`,o.style.color="red"}
