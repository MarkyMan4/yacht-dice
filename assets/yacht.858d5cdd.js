import"./style.c0ed6924.js";let y=sessionStorage.getItem("roomId"),m=sessionStorage.getItem("nickname"),l="",u=!1,p=document.getElementById("roll-btn"),f=document.getElementById("p1-total"),g=document.getElementById("p2-total"),o=document.getElementById("message-text");const r=["aces","deuces","threes","fours","fives","sixes","fourOfAKind","fullHouse","smallStraight","largeStraight","chance","yacht"];let d=new WebSocket(`ws://localhost:8000/ws/${y}`);d.onmessage=e=>{let t=JSON.parse(e.data);if(u||(I(t),u=!0),E(t),v(t),t.winner.trim()!=""){t.winner==="tie"?o.innerHTML="tie":o.innerHTML=`${t.winner} wins!`,o.style.color="blue";return}H(t),$(t),p.disabled=t.turn!==l||t.rollsLeft<=0,t.turn===l&&t.rollsLeft<3?T(t.scoreCard[l]):k(t.scoreCard[l])};d.onopen=e=>{d.send(JSON.stringify({eventType:"name",payload:{name:m}}))};p.addEventListener("click",()=>{let e={eventType:"roll"};d.send(JSON.stringify(e))});function I(e){document.getElementById("waiting-text")&&document.getElementById("waiting-text").remove(),document.getElementById("game").style.visibility="visible",l=e.p1.nickname===m?"p1":"p2",document.getElementById("you-title").innerHTML=`You are ${l}`,document.getElementById("p1-head").innerHTML=`p1<br>${e.p1.nickname}`,document.getElementById("p2-head").innerHTML=`p2<br>${e.p2.nickname}`}function E(e){a("p1",e.scoreCard.p1),a("p2",e.scoreCard.p2),f.innerHTML=e.totals.p1,g.innerHTML=e.totals.p2}function a(e,t){let i=Object.keys(t);i.forEach(n=>{document.getElementById(`${e}-${n}`).innerHTML=t[n],document.getElementById(`${e}-${n}`).className="scored-cell"}),r.forEach(n=>{i.includes(n)||(document.getElementById(`${e}-${n}`).innerHTML="")})}function $(e){Object.keys(e.scoreHints).forEach(t=>{document.getElementById(`${e.turn}-${t}`).innerHTML=e.scoreHints[t]})}function T(e){let t=Object.keys(e);r.forEach(i=>{t.includes(i)||(document.getElementById(`${l}-${i}`).onclick=B,document.getElementById(`${l}-${i}`).className="selectable-cell")})}function k(e){let t=Object.keys(e);r.forEach(i=>{document.getElementById(`${l}-${i}`).onclick=null,t.includes(i)||(document.getElementById(`${l}-${i}`).className="unscored-cell")})}function B(e){let t=e.target.id.split("-"),n={eventType:"score",payload:{category:t[t.length-1]}};d.send(JSON.stringify(n))}function L(e){let t=e.target.id.split("-"),n={eventType:"keep",payload:{die:parseInt(t[t.length-1])}};d.send(JSON.stringify(n))}function S(e){let t=e.target.id.split("-"),n={eventType:"unkeep",payload:{die:parseInt(t[t.length-1])}};d.send(JSON.stringify(n))}function v(e){let t="";for(let n=0;n<e.diceInPlay.length;n++){let s=e.diceInPlay[n];t+=`<div id="die-in-play-${n}" class="die-in-play">${s}</div>`}document.getElementById("dice-in-play").innerHTML=t;let i="";for(let n=0;n<e.diceKept.length;n++){let s=e.diceKept[n];i+=`<div id="die-kept-${n}" class="die-kept">${s}</div>`}if(document.getElementById("dice-kept").innerHTML=i,!(e.rollsLeft>=3)&&e.turn===l){let n=document.getElementsByClassName("die-in-play");for(let c of n)c.addEventListener("click",L);let s=document.getElementsByClassName("die-kept");for(let c of s)c.addEventListener("click",S)}}function H(e){e.turn===l?o.innerHTML="your turn":o.innerHTML=`${e.turn} is rolling...`,o.style.color="red"}
